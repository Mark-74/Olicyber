from missing_half import Lukasiewicz, xor
from Crypto.Util.number import long_to_bytes, bytes_to_long
import random

Lukasiewicz('08ae7eb31227acdb553aafec', log=True)
out = bytes.fromhex(open('missing-half.out', 'r').read().split(':0x')[1].strip())
before_f = long_to_bytes(Lukasiewicz('08ae7eb31227acdb553aa'))

# reverse c
x = long_to_bytes(160041365501716368448053427917678638214)
len_y = len(out)

while len(x) < len_y:
    x += x
x = x[:len_y]
y = xor(x, out)
y = bytes_to_long(y)

# reverse e
p = 2911721007088133262675953106197241703556747554305425259320716892314498939605330257723180761563459946872506915178651543859508747846871417959638013334210124890497567604326390324762618539999256667220682352421111253679877478493941553844107359114872928940037671284003186268154810467080223359
q = 101508832785985955552565353122121737721993273502298175210435222266367833577715998022894656354382850171462759222346590459054225243603686267128759721843436874152669720089862957418766772057931420195879446159380143921796986554177104777649965254024676644960176804859103133813804766266693420172934551827315872977254078260338793328596476945722634410151137268041424281547851223367780543620548301885832625481626226084395787868180619557254585495303587141192195620597534126355662587790632679436747378965477492157052992900323689771455598584904305855173463763288399527877718916799
phi = (p - 1) * (q - 1)
d = pow(0x10001, -1, phi)
msg = pow(y, d, p * q)
msg = long_to_bytes(msg)

FLAG = xor(before_f, msg)
print(FLAG.decode())